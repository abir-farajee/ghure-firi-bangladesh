<!doctype html>
<html lang="en" class="no-js">
{% load static %}

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="html5 responsive bootstrap template">
    <meta name="keywords" content="HTML,CSS,XML,JavaScript,html5,css3, responsive, bootstrap,jquery,">
    <link rel="shortcut icon" type="image/png" href="{% static 'admin/images/logo.png' %}">

    <title>ADMIN- GhureFiri Bangladesh </title>

    <link rel="stylesheet" href="{% static 'admin/css/bootstrap.min.css' %}">

    <link rel="stylesheet" href="{% static 'admin/css/font-awesome.min.css' %}">
    <link rel="stylesheet" href="{% static 'admin/css/flaticon.css' %}">

    <link rel="stylesheet" href="{% static 'admin/css/metisMenu.min.css' %}">

    <link rel="stylesheet" href="{% static 'admin/css/apexcharts.css' %}">

    <link rel="stylesheet" href="{% static 'admin/css/owl.carousel.min.css' %}">
    <link rel="stylesheet" href="{% static 'admin/css/owl.theme.default.min.css' %}">
    <link href="{% static 'admin/css/dropify.css' %}" rel="stylesheet">

    <link rel="stylesheet" href="{% static 'admin/vendors/datatable/css/datatables.min.css' %}">
    <link rel="stylesheet" href="{% static 'admin/vendors/datatable/css/dataTables.bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'admin/vendors/datatable/css/dataTables.jqueryui.min.css' %}">
    <link rel="stylesheet" href="{% static 'admin/vendors/datatable/css/jquery.dataTables.min.css' %}">

    <link rel="stylesheet" href="{% static 'admin/style.css' %}">
    <link rel="stylesheet" href="{% static 'admin/css/responsive.css' %}">

    <script src="{% static 'admin/vendors/modernizr-js/modernizr.js' %}" type="text/javascript"></script>


</head>

<body>
    <div class="top-bar">
        <header>
            <div class="bottom-header">
                <div class="container-fluid">
                    <div class="row align-items-center">
                        <div class="col-lg-12 col-md-12">
                            <div class="menu-toggler">
                                <span></span>
                                <span></span>
                                <span></span>
                            </div>
                            <div class="bottom-header-right-content">
                                <div class="row align-items-center">
                                    <div class="col-lg-6 offset-lg-1 col-md-6 offset-md-1 col-sm-6 offset-sm-1">

                                    </div>
                                    <div class="col-lg-5 col-md-5 col-sm-5">
                                        <ul>

                                                  <li>
                                                <div class="dropdown profile">
                                                    <button aria-expanded="false" aria-haspopup="true" class="btn dropdown-toggle" data-toggle="dropdown" id="dropdownMenuButton2" type="button">
                                                        <span class="profile-avater">
                                                            <img src="{% static 'admin/images/logo.png' %}"
                                                                class="img-fluid" alt="">
                                                        </span>
                                                        <span class="name">GhureFiri Bangladesh Admin</span>
                                                    </button>
                                                    <div aria-labelledby="dropdownMenuButton" class="dropdown-menu dropdown-menu-right">
                                                        <div class="profile-avater-show">
                                                            <div class="img">
                                                                <img src="{% static 'admin/images/logo.png' %}" class="img-fluid" alt="">
                                                            </div>
                                                            <h6>GhureFiri Bangladesh Admin</h6>
                                                        </div>

                                                        <a class="dropdown-item" href="adminlogout"><i
                                                                class="fa fa-sign-out"></i> logout</a>
                                                    </div>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>
    </div>
    <div class="sidebar scrollbar-macosx">
        <div class="menu-close">
            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-x" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd"
                    d="M11.854 4.146a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708-.708l7-7a.5.5 0 0 1 .708 0z" />
                <path fill-rule="evenodd"
                    d="M4.146 4.146a.5.5 0 0 0 0 .708l7 7a.5.5 0 0 0 .708-.708l-7-7a.5.5 0 0 0-.708 0z" />
            </svg>
        </div>
        <div class="site-logo">
            <a href="index.html">
                <img src="images/logo.png" class="img-fluid" alt="">
            </a>
        </div>
        <nav>
            <ul id="metismenu">
                <li><a href="adminhome"><i class="fi flaticon-dashboard"></i>Dashboard</a></li>
                <li><a href="addpackage"><i class="fi flaticon-plus"></i>Add Package</a></li>
                <li><a href="addtour"><i class="fi flaticon-plus"></i>Add Tour Place </a></li>
                <li><a href="addhotel"><i class="fi flaticon-plus"></i>Add Hotel</a></li>
                <li><a href="addtransportation"><i class="fi flaticon-plus"></i>Add Transportation</a></li>
                <li><a href="tourlist"><i class="fi flaticon-plus"></i>All Tour</a></li>
                <li><a href="packagelist"><i class="fi flaticon-plus"></i>Manage Package</a></li>
                <li><a href="packbooked"><i class="fi flaticon-plus"></i>Manage Package Booking</a></li>
                <li class="active"><a href="#"><i class="fi flaticon-plus"></i>Manage Tour Booking</a></li>
                <li> <a class="dropdown-item" href="adminlogout"><i class="fa fa-sign-out"></i> logout</a><li>


            </ul>
        </nav>
    </div>


    <div class="content-wrapper">
        <div class="container-fluid">
            <div class="page-breadcrumb">
                <div class="row align-items-center">
                    <div class="col-lg-10 col-sm-6 col-12">
                        <ul>
                            <li><a href="adminhome">Dashboard</a></li>
                            <li class="active">BOOKED PACKAGES</li>
                        </ul>
                    </div>
                    <div class="col-lg-2 col-sm-6 col-12">
                        <div class="brcm-btn">
                            <a class="theme-btn" href="adminhome">DASHBOARD</a>
                        </div>
                    </div>
                </div>
            </div>

            <div class="booking-area">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="booking-dash-wrap dash-card">


                            {% for place_name,total_price,paystatus,transactionID,admin_transaction,username,userphone,booking_id in bookedtourdata %}
                            <div class="booking-item">
                                <div class="row">
                                    <div class="col-lg-9">
                                        <div class="booking-left">

                                            <div class="booking-text">
                                                <h2>Package Name:&nbsp{{place_name}} ({{total_price}} BDT) {% ifequal paystatus 'Processing' %} ({{transactionID}}){% endifequal %}</h2>
                                                <ul>
                                                    <li>Booked By:&nbsp<strong>{{username}}</strong> </li>
                                                    <li>Contact No:&nbsp<strong>{{userphone}}</strong> </li>


                                                </ul>
                                            </div>
                                        </div>
                                    </div>


                                    <div class="col-lg-3">
                                        <div class="booking-btn">
                                            {% ifequal paystatus 'Paid' %}
                                            <h4 style="color: rgb(0, 138, 34);">Confirmed </h4>
                                            {% endifequal %} {% ifequal paystatus 'Unpaid' %}
                                            <h4 style="color: rgb(250, 20, 20);">Not Paid Yet </h4>
                                            {% endifequal %} {% ifequal paystatus 'Resend' %}
                                            <h4 style="color: rgb(6, 135, 255);">Requested for Resend TrxID </h4>
                                            {% endifequal %} {% ifequal paystatus 'Processing' %} {% ifequal transactionID admin_transaction %}
                                            <h4 style="color: rgb(32, 66, 255);">Paid & Transaction ID Matched </h4>
                                            <a class="theme-btn approve" type="button" data-toggle="modal" data-target="#confirm{{booking_id}}" href="#">Confirm Booking</a> {% else %}
                                            <h4 style="color: rgb(238, 120, 42);">TrxID Not Matched </h4>
                                            <a class="theme-btn reject" type="button" data-toggle="modal" data-target="#recheck{{booking_id}}" href="#">Request for Re-Check</a>{% endifequal %} {% endifequal %}



                                        </div>
                                    </div>

                                </div>
                            </div>




                            <!----------------------------------------------------------DELETE PACKAGE -------------------------------------------------------------------->



                            <div class="modal fade" id="Delete{{tourid}}" tabindex="-1" role="dialog" style="z-index: 9999; background-color: rgb(43, 46, 45);" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                <div class="modal-dialog modal-sm modal-dialog-centered modal-notify modal-danger" role="document">
                                    <!--Content-->
                                    <div class="modal-content text-center">
                                        <!--Header-->
                                        <div class="modal-header d-flex justify-content-center">
                                            <p class="heading">Are you sure?</p>
                                        </div>

                                        <!--Body-->
                                        <div class="modal-body">

                                            Delete {{tour_name}}&nbsp ?

                                        </div>

                                        <!--Footer-->
                                        <div class="modal-footer flex-center">
                                            <form action="deletetour" method="post">
                                                {% csrf_token %}
                                                <input type="hidden" name="tourid" value="{{tourid}}">
                                                <button type="submit" class="btn  btn-outline-danger">Yes</button>
                                            </form>
                                            <a type="button" class="btn  btn-danger waves-effect" data-dismiss="modal">No</a>
                                        </div>
                                    </div>
                                    <!--/.Content-->
                                </div>
                            </div>



                            <!----------------------------------------------------------CONFIRM BOOKING-------------------------------------------------------------------->



                            <div class="modal fade" id="confirm{{booking_id}}" tabindex="-1" role="dialog" style="z-index: 9999; background-color: rgb(43, 46, 45);" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                <div class="modal-dialog modal-sm modal-dialog-centered modal-notify modal-danger" role="document">
                                    <!--Content-->
                                    <div class="modal-content text-center">
                                        <!--Header-->
                                        <div class="modal-header d-flex justify-content-center">
                                            <p class="heading">Are you sure to confirm ?</p>
                                        </div>

                                        <!--Body-->
                                        <div class="modal-body">

                                            Customer Provided TrxID : {{transactionID}} <br> Database TrxID : {{admin_transaction}} <br>

                                        </div>

                                        <!--Footer-->
                                        <div class="modal-footer flex-center">
                                            <form action="comfirmtourbooking" method="post">
                                                {% csrf_token %}
                                                <input type="hidden" name="bookingid" value="{{booking_id}}">
                                                <button type="submit" class="btn  btn-outline-danger">Yes</button>
                                            </form>
                                            <a type="button" class="btn  btn-danger waves-effect" data-dismiss="modal">No</a>
                                        </div>
                                    </div>
                                    <!--/.Content-->
                                </div>
                            </div>

                            <!----------------------------------------------------------RECHECK REQUEST-------------------------------------------------------------------->



                            <div class="modal fade" id="recheck{{booking_id}}" tabindex="-1" role="dialog" style="z-index: 9999; background-color: rgb(43, 46, 45);" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                <div class="modal-dialog modal-sm modal-dialog-centered modal-notify modal-danger" role="document">
                                    <!--Content-->
                                    <div class="modal-content text-center">
                                        <!--Header-->
                                        <div class="modal-header d-flex justify-content-center">
                                            <p class="heading">Send Request</p>
                                        </div>

                                        <!--Body-->
                                        <div class="modal-body">

                                            Customer Provided TrxID : {{transactionID}} <br> Database TrxID : {{admin_transaction}} <br>

                                        </div>

                                        <!--Footer-->
                                        <div class="modal-footer flex-center">
                                            <form action="recheckreq" method="post">
                                                {% csrf_token %}
                                                <input type="hidden" name="bookingid" value="{{booking_id}}">
                                                <button type="submit" class="btn  btn-outline-danger">Yes</button>
                                            </form>
                                            <a type="button" class="btn  btn-danger waves-effect" data-dismiss="modal">No</a>
                                        </div>
                                    </div>
                                    <!--/.Content-->
                                </div>
                            </div>




                            {% endfor %}

                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>





    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>



    <script src="{% static 'assets/js/zepto.min.js' %}"></script>
    <script src="https://www.gstatic.com/firebasejs/3.7.4/firebase.js"></script>
    <script>
        $().ready(function() {


            $('input[name=photo]').change(function(e) {
                var file = e.target.files[0];



                // CANVAS RESIZING
                canvasResize(file, {
                    width: 500,
                    height: 500,
                    crop: false,
                    quality: 50,
                    rotate: 0,
                    callback: function(data, width, height) {


                        var img = new Image();
                        img.onload = function() {

                            $(this).css({
                                'margin': '10px auto',
                                'width': width,
                                'height': height
                            }).appendTo('#area div');

                        };
                        $(img).attr('src', data);

                        var fd = new FormData();
                        // Add file data
                        var f = canvasResize('dataURLtoBlob', data);
                        f.name = file.name;

                        var config = {
                            apiKey: "AIzaSyAPBXBYOuClJop3F3aDEOhfF1kZjhUxGFA",
                            authDomain: "ghurefiribangladesh-e7ef2.firebaseapp.com",
                            databaseURL: "https://ghurefiribangladesh-e7ef2.firebaseio.com",
                            projectId: "ghurefiribangladesh-e7ef2",
                            storageBucket: "ghurefiribangladesh-e7ef2.appspot.com",
                            messagingSenderId: "198487718440",
                            appId: "1:198487718440:web:ab16558cabb12902c7931d",
                            measurementId: "G-B8PY09CQDG"
                        };
                        firebase.initializeApp(config);
                        var storage = firebase.storage();

                        document.getElementById("demo").onclick = function() {
                            myFunction()
                        };

                        function myFunction() {

                            var storageRef = storage.ref();
                            var thisref = storageRef.child("package_images").child(f.name).put(f);
                            thisref.on('state_changed', function(snapshot) {
                                    console.log("file uplaoded succesfully");
                                },
                                function(error) {},
                                function() {

                                    var downloadURL = thisref.snapshot.downloadURL;
                                    console.log("got url");
                                    document.getElementById("url").value = downloadURL;
                                    alert("file uploaded successfully");
                                    document.myForm.submit();
                                });

                        };


                    }
                });

            });
        });
    </script>
    <script src="{% static 'assets/js/binaryajax.js' %}"></script>
    <script src="{% static 'assets/js/exif.js' %}"></script>
    <script src="{% static 'assets/js/canvasResize.js' %}"></script>


    <script src="{% static 'admin/js/jquery.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'admin/js/popper.min.js' %}" type="text/javascript"></script>

    <script src="{% static 'admin/js/bootstrap.min.js' %}" type="text/javascript"></script>

    <script src="{% static 'admin/js/metisMenu.min.js' %}" type="text/javascript"></script>

    <script src="{% static 'admin/js/owl.carousel.min.js' %}" type="text/javascript"></script>

    <script src="{% static 'admin/js/waypoints.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'admin/js/counterup.min.js' %}" type="text/javascript"></script>

    <script src="{% static 'admin/js/jquery.scrollbar.min.js' %}" type="text/javascript"></script>

    <script src="{% static 'admin/js/apexcharts.js' %}" type="text/javascript"></script>
    <script src="{% static 'admin/js/dropify.js' %}" type="text/javascript"></script>
    <script src="{% static 'admin/js/form-file-uploads.js' %}" type="text/javascript"></script>

    <script src="{% static 'admin/vendors/datatable/js/datatables.min.js" type="text/javascript"></script>
    <script src="{% static 'admin/vendors/datatable/js/dataTables.bootstrap.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'admin/vendors/datatable/js/dataTables.jqueryui.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'admin/vendors/datatable/js/jquery.dataTables.min.js' %}" type="text/javascript"></script>

    <script src="{% static 'admin/js/scripts.js' %}" type="text/javascript"></script>
    <script src="{% static 'admin/assets/js//rocket-loader.min.js' %}" type="text/javascript"></script>
</body>


</html>